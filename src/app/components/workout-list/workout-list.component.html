<div class="container">
  <div class="header">
    <h1>カレンダー</h1>
    <p class="text-muted-foreground">
      カレンダーでトレーニング記録を確認できます。
    </p>
  </div>

  <div class="main-grid">
    <!-- カレンダー部分 -->
    <div class="calendar-container">
      <!-- カレンダーヘッダー -->
      <div class="calendar-header">
        <button class="calendar-nav-button">前月</button>
        <h2 class="calendar-title">
          {{ currentDate | date : "Y年M月" }}
        </h2>
        <button class="calendar-nav-button">次月</button>
      </div>

      <!-- カレンダーグリッド -->
      <div class="calendar-grid">
        <!-- 曜日ヘッダー -->
        <div class="weekday-header">
          @for (day of ['日', '月', '火', '水', '木', '金', '土']; track day) {
          <div class="weekday-cell">
            {{ day }}
          </div>
          }
        </div>

        <!-- カレンダー日付 -->
        <div class="date-grid">
          @for (date of calendarDays; track date) {
          <div
            [class.inactive-date]="!isCurrentMonth(date)"
            [class.active-date]="isCurrentMonth(date)"
            [class.selected-date]="
              workoutService.getDateString(date) === selectedDate
            "
            class="date-cell"
            (click)="selectDate(date)"
          >
            <!-- 日付 -->
            <div class="date-content">
              <div class="date-number">
                @if (isToday(date)) {
                <div class="today-marker">
                  {{ date | date : "d" }}
                </div>
                } @else {
                <div class="date-text">
                  {{ date | date : "d" }}
                </div>
                }
              </div>
            </div>
          </div>
          }
        </div>
      </div>

      <!-- 詳細表示 -->
      <div class="workout-details">
        @if (selectedDate && getSelectedWorkout()) {
        <div class="workout-info">
          <div class="workout-header">
            <h3>{{ selectedDate | date : "Y年M月d日" }}のワークアウト</h3>
            <button class="delete-button">削除</button>
          </div>

          <div class="exercise-list">
            @for (workout of getSelectedWorkout()!; track workout.id) { @for
            (exercise of workout.exercises; track exercise.name) {
            <div class="exercise-item">
              <button class="exercise-button">
                <div class="exercise-header">
                  <h4>{{ exercise.name }}</h4>
                  <span>{{ exercise.sets.length }}セット</span>
                </div>
                <div
                  class="expand-icon"
                  [class.expanded]="
                    isExerciseExpanded(workout.id, exercise.name)
                  "
                >
                  <svg
                    class="chevron-icon"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  >
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </div>
              </button>

              @if (isExerciseExpanded(workout.id, exercise.name)) {
              <div class="sets-container">
                @for (set of exercise.sets; track $index) {
                <div class="set-item">
                  <div class="set-details">
                    <span class="set-number">セット{{ $index + 1 }}</span>
                    <div class="weight-info">
                      <span>{{ set.weight }}</span>
                      <span>kg</span>
                    </div>
                    <div class="reps-info">
                      <span>{{ set.reps }}</span>
                      <span>回</span>
                    </div>
                  </div>
                  <div class="total-weight">{{ set.weight * set.reps }}kg</div>
                </div>
                }
              </div>
              }
            </div>
            } }
          </div>
        </div>
        } @else {
        <div class="no-selection">日付を選択してください。</div>
        }
      </div>
    </div>
  </div>
</div>
